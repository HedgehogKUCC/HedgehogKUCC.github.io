---
title: Gulp
date: 2019-11-16
tags: gulp
---

# Gulp - Quick Start

## 安裝環境

1. [Node.js](https://nodejs.org/en/)

2. gulp-cli

```bash
$ sudo npm install gulp-cli -g
```

<br>

## 環境建置

### 產生出一個 `package.json`

```bash
$ npm init
```

### 安裝 `gulp 4.x.x`

```bash
npm install --sava-dev gulp
```

### 新增 `gulpfile.js`

新增資料夾 `source` 裡面在新增 `index.html`

<br>

## 範例： 使用 task 複製文件至指定資料夾下

`gulpfile.js`

```js
var gulp = require('gulp');

gulp.task('copyHTML', function () {
  return gulp.src('./source/**/*.html')
    .pipe(gulp.dest('./public/'))
})
```

出現 `ReferenceError: primordials is not defined` [連結](https://stackoverflow.com/questions/55921442/how-to-fix-referenceerror-primordials-is-not-defined-in-node)

原因是 `node v12.x.x` 和 `gulp v3.9.x`

解決方法 (二擇一)

1. node 降至 v11
2. gulp 升至 v4

本來使用 ***方法1*** 是由於課程使用 `gulp 3.9.1`

但是發現 `解除安裝 Node` 太過麻煩

所以改用 ***方法2***

```bash
$ gulp copyHTML
```

會看到 source 資料夾下的 index.html 

複製出一份到 public 資料夾下

<br>

# gulp-jade

[npm-jade](https://www.npmjs.com/package/gulp-jade)

## 安裝

```bash
$ npm install --save gulp-jade
```

<br>

## Quick Start

1. 將 `source` 的 `index.html` 刪除，新建 `index.jade`
2. 將 `public` 資料夾刪除

### gulpfile.js

```js
var jade = require('gulp-jade');

gulp.task('jade', function() {
  // var YOUR_LOCALS = {};
 
  return gulp.src('./source/**/*.jade')
    .pipe(jade({
      // locals: YOUR_LOCALS
      pretty: true
    }))
    .pipe(gulp.dest('./public/'))
});
```

因為 `gulp v4` 的關係請在 `gulp.src` 前面加上 `return`

不然會跳出以下訊息

- The following tasks did not complete: jade
- Did you forget to signal async completion?

```bash
$ gulp jade
```

就會成功將 `.jade` 編譯成 `.html`

`pretty: true` : 會將 `.html` 內容展開

沒有加上 `pretty: true` 就會是 ***壓縮過後*** 的 `.html`
